---
import Base from '../layouts/Base.astro';
import Hero from '../components/Hero.astro';

const base = import.meta.env.BASE_URL;
const withBase = (path) => `${base}${path.replace(/^\/+/, '')}`;

const hardwareBoards = [
  {
    name: 'Scaffold',
    description: 'Multi-purpose board to control devices with embedded features such as: current consumption measurement, multiple communication protocols (SPI, IÂ²C, UART...), command triggering, pulse generators...',
    image: withBase('/img/tools-suite/scaffold-board.png'),
    repo: 'https://github.com/Ledger-Donjon/scaffold/'
  },
  {
    name: 'Curmea',
    description: 'Simple board for differential current consumption measurement.',
    image: withBase('/img/tools-suite/curmea.png'),
    repo: 'https://github.com/Ledger-Donjon/curmea/'
  },
  {
    name: 'Silicon Toaster',
    description: 'Board to inject electromagnetic pulses from a bank of capacitors, that can be loaded to a programmable level of voltage, and discharged with a triggering input source.',
    image: withBase('/img/tools-suite/silicontoaster.png'),
    repo: 'https://github.com/Ledger-Donjon/silicon-toaster/'
  },
  {
    name: 'Shutter Controller',
    description: "A low-cost motorized add-on of optical tower on ALPhANOV's Laser Microscope Station to control a mechanical shutter.",
    image: withBase('/img/tools-suite/shutter-controller.png'),
    repo: 'https://github.com/Ledger-Donjon/shutter-controller/'
  }
];

const hardwareSoftware = [
  {
    name: 'Laser Studio',
    description: 'Multi-environment python3 software controlling hardware benches to conduct automatized evaluations.',
    repo: 'https://github.com/Ledger-Donjon/laserstudio/'
  },
  {
    name: 'pystages',
    description: 'Python module for managing the positions of physical actuators, such as CNCs, Corvus, or Newport. Also provides a simple User Interface to make easy and quick moves of actuators.',
    image: withBase('/img/tools-suite/pystages.png'),
    imageFit: 'contain',
    imageStyle: 'app',
    repo: 'https://github.com/Ledger-Donjon/pystages/'
  },
  {
    name: 'pyPDM',
    description: "This python module can control the Pulse-on-Demand Modules from ALPhANOV.",
    repo: 'https://github.com/Ledger-Donjon/pypdm/'
  },
  {
    name: 'Quicklog',
    description: 'Python module for creating log files during a fault injection campaign. It can link each entry to curve as binary data, for instance retrieved from an oscilloscope.',
    repo: 'https://github.com/Ledger-Donjon/quicklog/'
  },
  {
    name: 'Quicklog Explorer',
    description: 'GUI utility for viewing, filtering and plotting generated with Quicklog.',
    repo: 'https://github.com/Ledger-Donjon/quicklog-explorer/'
  },
  {
    name: 'Turboplot',
    description: 'A blazingly fast waveform renderer made for visualizing huge traces.',
    image: withBase('/img/tools-suite/turboplot.png'),
    repo: 'https://github.com/Ledger-Donjon/turboplot/'
  },
  {
    name: 'Visplot',
    description: 'A side-channel traces visualizer based on vispy.',
    image: withBase('/img/tools-suite/visplot.gif'),
    repo: 'https://github.com/Ledger-Donjon/visplot/'
  },
  {
    name: 'Rainbow',
    description: 'Makes Unicorn traces. Generic Side-Channel and Fault Injection simulator.',
    repo: 'https://github.com/Ledger-Donjon/rainbow/'
  }
];

const sideChannelTools = [
  {
    name: 'Muscat',
    description: 'Side-channel analysis tool written in Rust for performance optimizations.',
    repo: 'https://github.com/Ledger-Donjon/muscat/'
  },
  {
    name: 'Scadl',
    description: 'Side-channel analysis tool with Deep-Learning features.',
    repo: 'https://github.com/Ledger-Donjon/scadl/'
  },
  {
    name: 'Lascar',
    description: 'Our legacy side-channel python3 library.',
    repo: 'https://github.com/Ledger-Donjon/lascar/'
  }
];

const softwareTools = [
  {
    name: 'Zorya',
    description: "Automated concolic execution engine optimized for Go binaries analysis, using Ghidra's P-Code as IR, and written in Rust.",
    repo: 'https://github.com/Ledger-Donjon/zorya/'
  },
  {
    name: 'cargo-checkct',
    description: 'Written in Rust, it verifies formally if a software is compiled down to constant-time machine code.',
    repo: 'https://github.com/Ledger-Donjon/cargo-checkct'
  }
];
---

<Base title="Tools Suite" description="Open-source security research tools developed by the Ledger Donjon team.">
  <Hero 
    title="Donjon Tools Suite" 
    subtitle="The Security Team at Ledger develops and open-sources their research and assessment tools."
    size="sm" 
  />
  
  <section class="content">
    <div class="container">
      <p class="intro">
        This page presents our tools in different categories: 
        <a href="#hardware-tools">Hardware</a> and <a href="#software-tools">Software</a> related.
        You can also check out the <a href="https://github.com/Ledger-Donjon" target="_blank" rel="noopener">Ledger-Donjon GitHub organization</a>.
      </p>
      
      <section id="hardware-tools" class="tools-section">
        <h2>
          <span class="section-icon">ðŸ”§</span>
          Hardware Attack & Analysis Tools
        </h2>
        
        <h3>Boards</h3>
        <div class="tools-grid">
          {hardwareBoards.map((tool) => (
            <article class="tool-card">
              {tool.image && (
                <div
                  class:list={[
                    'tool-card__image',
                    { 'tool-card__image--app': tool.imageStyle === 'app' }
                  ]}
                >
                  <img
                    src={tool.image}
                    alt={tool.name}
                    loading="lazy"
                    class:list={['tool-card__img', { 'tool-card__img--contain': tool.imageFit === 'contain' }]}
                  />
                </div>
              )}
              <div class="tool-card__content">
                <h4>{tool.name}</h4>
                <p>{tool.description}</p>
                <a href={tool.repo} class="tool-card__link" target="_blank" rel="noopener noreferrer">
                  <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                  </svg>
                  Repository
                </a>
              </div>
            </article>
          ))}
        </div>
        
        <h3>Software and Utilities</h3>
        <p class="section-desc">Useful utilities while performing hardware attacks.</p>
        <div class="tools-grid">
          {hardwareSoftware.map((tool) => (
            <article class="tool-card">
              {tool.image && (
                <div
                  class:list={[
                    'tool-card__image',
                    { 'tool-card__image--app': tool.imageStyle === 'app' }
                  ]}
                >
                  <img
                    src={tool.image}
                    alt={tool.name}
                    loading="lazy"
                    class:list={['tool-card__img', { 'tool-card__img--contain': tool.imageFit === 'contain' }]}
                  />
                </div>
              )}
              <div class="tool-card__content">
                <h4>{tool.name}</h4>
                <p>{tool.description}</p>
                <a href={tool.repo} class="tool-card__link" target="_blank" rel="noopener noreferrer">
                  <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                  </svg>
                  Repository
                </a>
              </div>
            </article>
          ))}
        </div>
        
        <h3>Side-channel Tools</h3>
        <div class="tools-grid tools-grid--small">
          {sideChannelTools.map((tool) => (
            <article class="tool-card tool-card--compact">
              <div class="tool-card__content">
                <h4>{tool.name}</h4>
                <p>{tool.description}</p>
                <a href={tool.repo} class="tool-card__link" target="_blank" rel="noopener noreferrer">
                  <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                  </svg>
                  Repository
                </a>
              </div>
            </article>
          ))}
        </div>
      </section>
      
      <section id="software-tools" class="tools-section">
        <h2>
          <span class="section-icon">ðŸ’»</span>
          Software Attack & Analysis Tools
        </h2>
        
        <div class="tools-grid tools-grid--small">
          {softwareTools.map((tool) => (
            <article class="tool-card tool-card--compact">
              <div class="tool-card__content">
                <h4>{tool.name}</h4>
                <p>{tool.description}</p>
                <a href={tool.repo} class="tool-card__link" target="_blank" rel="noopener noreferrer">
                  <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                  </svg>
                  Repository
                </a>
              </div>
            </article>
          ))}
        </div>
      </section>
    </div>
  </section>
</Base>

<style lang="scss">
  .content {
    padding: var(--space-12) 0;
  }
  
  .intro {
    font-size: var(--text-lg);
    color: var(--color-text-secondary);
    max-width: 700px;
    margin-bottom: var(--space-12);
  }
  
  .tools-section {
    margin-bottom: var(--space-16);
    
    h2 {
      display: flex;
      align-items: center;
      gap: var(--space-3);
      font-size: var(--text-2xl);
      margin-bottom: var(--space-8);
      padding-bottom: var(--space-4);
      border-bottom: 1px solid var(--color-border);
    }
    
    h3 {
      font-size: var(--text-lg);
      margin-top: var(--space-10);
      margin-bottom: var(--space-4);
      color: var(--color-text-secondary);
    }
  }
  
  .section-icon {
    font-size: 1.5rem;
  }
  
  .section-desc {
    font-size: var(--text-sm);
    color: var(--color-text-tertiary);
    margin-bottom: var(--space-6);
  }
  
  .tools-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: var(--space-6);
    
    &--small {
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    }
  }
  
  .tool-card {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    overflow: hidden;
    transition: all var(--transition-normal);
    display: flex;
    flex-direction: column;
    
    &:hover {
      border-color: var(--color-border-hover);
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }
    
    &--compact {
      .tool-card__content {
        padding: var(--space-5);
      }
    }
    
    &__image {
      aspect-ratio: 16 / 10;
      background: var(--color-bg-tertiary);
      overflow: hidden;
      display: block;
      
      img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform var(--transition-slow);
      }
    }

    &__image--app {
      display: flex;
      align-items: center;
      justify-content: center;

      img {
        width: 60%;
        height: 60%;
        object-fit: contain;
        background: var(--color-bg-secondary);
        padding: var(--space-3);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-sm);
      }
    }

    &__img--contain {
      object-fit: contain;
      padding: var(--space-3);
    }
    
    &:hover &__image img {
      transform: scale(1.05);
    }
    
    &__content {
      padding: var(--space-5);
      display: flex;
      flex-direction: column;
      flex: 1;
      
      h4 {
        font-size: var(--text-lg);
        margin-bottom: var(--space-2);
        color: var(--color-text-primary);
      }
      
      p {
        font-size: var(--text-sm);
        color: var(--color-text-secondary);
        margin-bottom: var(--space-4);
        line-height: var(--leading-relaxed);
      }
    }
    
    &__link {
      display: inline-flex;
      align-items: center;
      gap: var(--space-2);
      font-size: var(--text-sm);
      font-weight: 500;
      color: var(--color-accent-primary);
      margin-top: auto;
      
      &:hover {
        text-decoration: underline;
      }
    }
  }
</style>
